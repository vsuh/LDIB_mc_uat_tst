@NonCPS
def getBuildUser() {
    return currentBuild.rawBuild.getCause(Cause.UserIdCause).getUserId()
}
pipeline {
  agent{ label 'mini' }
  environment {
    LIB = load 'lib/Common.groovy'
    ib = "${JOB_BASE_NAME}"
    tb = "${ib[0..5]}"
    IbTitle = LIB.strIbTitle(ib)
    // runAllowed = LIB.getValueRedis(ib)
    cs = 'lib/create-script.os'
    CLADDR = 'obr-app-13'
    SQLSRV = 'obr-sql-01'
    SQLbackup = '\\\\192.168.3.56\\backup'
    VER1C = '8.3.18.1483'
    enCode = '0008'
    scPath = "${env.WORKSPACE}/SQL_${ib}.SQLscript"

  }
  stages {
    stage('0. Разрешение запуска'){
      steps{
        script {

          echo "--------------------"
          echo currentBuild.getBuildCauses('hudson.model.Cause$UserIdCause')[0]['userId']
          echo "--------------------"
         
          echo "-------OK(vsuh)-------------"
          echo getBuildUser()
          echo "--------------------"

          echo "---------OK(Сухих)---------"
          echo currentBuild.rawBuild.getCause(Cause.UserIdCause).getUserName()
          echo "--------------------"
        }
      }
    }
  }
}
